% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/create_PA_matrix.R
\name{create_PA_matrix}
\alias{create_PA_matrix}
\title{Create presence/absence matrix from count data}
\usage{
create_PA_matrix(
  count_matrix,
  target_cpm = 0.5,
  min_reads_floor = 3L,
  normalization_method = "TMMwsp"
)
}
\arguments{
\item{count_matrix}{Matrix or data.frame of count data (features x samples).
Rownames should be feature IDs, colnames should be sample IDs.}

\item{target_cpm}{CPM threshold for presence (default: 0.5)}

\item{min_reads_floor}{Minimum raw read count threshold (default: 3)}

\item{normalization_method}{edgeR normalization method (default: "TMMwsp" for sparse data)}
}
\value{
A numeric matrix (0/1) with same dimensions and dimnames as input
}
\description{
Converts a count matrix to presence/absence (0/1) using TMM normalization
and CPM thresholding. A feature is considered "present" if its normalized
CPM >= target_cpm AND raw count >= min_reads_floor.
}
\details{
This function uses edgeR's TMM (trimmed mean of M-values) normalization,
which is robust for sparse microbiome data. The "TMMwsp" method is
specifically designed for data with many zeros.

The presence rule requires BOTH conditions:
- Normalized CPM >= target_cpm
- Raw count >= min_reads_floor

This guards against calling rare features "present" due to normalization
artifacts.
}
\examples{
\dontrun{
# Create PA matrix from counts
PA_matrix <- create_PA_matrix(
  count_matrix = my_counts,
  target_cpm = 0.5,
  min_reads_floor = 3
)

# More stringent threshold
PA_strict <- create_PA_matrix(
  count_matrix = my_counts,
  target_cpm = 1.0,
  min_reads_floor = 5
)
}
}
