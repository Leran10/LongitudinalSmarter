% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plotting.R
\name{plot_longitudinal_heatmaps}
\alias{plot_longitudinal_heatmaps}
\title{Create heatmaps for longitudinal results by term family}
\usage{
plot_longitudinal_heatmaps(
  df,
  tp_levels,
  fdr = 0.05,
  value = c("log_odds", "OR"),
  min_features = 1,
  feature_id_col = "feature_id",
  ref_level = "CONTROL",
  non_ref_level = "CELIAC",
  timepoint_var = "onset_timeline_combined"
)
}
\arguments{
\item{df}{Data frame of results (typically the `combined` output from fit_longitudinal_PA)}

\item{tp_levels}{Character vector of timepoint levels (excluding baseline if desired)}

\item{fdr}{FDR threshold for significance (default: 0.05)}

\item{value}{Type of value to plot: "log_odds" or "OR" (odds ratio)}

\item{min_features}{Minimum number of significant timepoints required for a feature to be shown}

\item{feature_id_col}{Name of feature ID column (default: "feature_id")}

\item{ref_level}{Reference diagnosis level (e.g., "CONTROL")}

\item{non_ref_level}{Non-reference diagnosis level (e.g., "CELIAC")}

\item{timepoint_var}{Name used in term labels for timepoints (default: "onset_timeline_combined")}
}
\value{
Named list of ggplot objects, one per detected term family
}
\description{
Auto-detects different types of contrasts in the results and creates
heatmaps showing significant results. Only cells with FDR < threshold are colored.
}
\examples{
\dontrun{
# After fitting models
results <- fit_longitudinal_PA(...)

# Create heatmaps
plots <- plot_longitudinal_heatmaps(
  df = results$combined,
  tp_levels = c("t0-6", "t0-12", "t0-18", "t0-24"),
  fdr = 0.05,
  value = "log_odds"
)

# View individual plots
plots$`TP (CONTROL)`
plots$`TP (CELIAC)`
}
}
